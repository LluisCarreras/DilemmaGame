<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask Number Guessing Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        input, button {
            padding: 10px;
            margin: 5px;
        }
        #cooperate_button {
        background-color: green;
        color: white; /* Text color inside the button */
        }
        #defect_button {
            background-color: red;
            color: white; /* Text color inside the button */
        }
        table {
            max-width: 300px;
            border-collapse: collapse;
            margin: 0 auto;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Dilemma...</h1>
    <p id="message">Cooperate or defect?</p>
    <div>
        <!-- Buttons to trigger the action -->
        <button id="cooperate_button" onclick="makeTurn(1)">Cooperate</button>
        <button id="defect_button" onclick="makeTurn(0)">Defect</button>
    </div>

    <!-- Table to show player results -->
    <table id="player-table">
        <thead>
            <tr>
                <th>Turn</th>
                <th>P1 value</th>
                <th>P2 value</th>
                <th>P1 score</th>
                <th>P2 score</th>
            </tr>
        </thead>
        <tbody>
            <!-- New rows will be inserted here -->
        </tbody>
    </table>
    <script>
        // Function to add a new row to the table
        function addRow(turnValue, p1Value, p2Value, p1Score, p2Score) {
            const table = document.getElementById("player-table");
            const newRow = table.insertRow(1); // Insert row at the first position after the header

            const cell_turn = newRow.insertCell(0);
            const cell_p1_value = newRow.insertCell(1);
            const cell_p2_value = newRow.insertCell(2);
            const cell_p1_score = newRow.insertCell(3);
            const cell_p2_score = newRow.insertCell(4);

            cell_turn.textContent = turnValue;
            cell_p1_value.textContent = p1Value;
            cell_p2_value.textContent = p2Value;
            cell_p1_score.textContent = p1Score;
            cell_p2_score.textContent = p2Score;
        }
        async function makeTurn(doesCooperate) {
            const response = await fetch('/guess', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ guess: doesCooperate })
            });

            const result = await response.json();
            const message = result.message;
            const value_turn = result.value_turn;
            const value_p1 = result.value_p1;
            const value_p2 = result.value_p2;
            const score_p1 = result.score_p1;
            const score_p2 = result.score_p2;
            document.getElementById('message').textContent = message;
            addRow(value_turn, value_p1, value_p2, score_p1, score_p2)
        }
    </script>
</body>
</html>
